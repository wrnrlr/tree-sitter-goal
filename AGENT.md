# AGENT.md
Help me develop the tree-sitter grammer for the Goal Array Language.

## File Structure

- `grammar.js`: The grammar definition.
- `src/`: Generated parser files (ignore, generated by tree-sitter).
- `test/`: Test files (`.goal` source code).
  - `test/corpus`: tree-sitter parser test, run with `tree-sitter test`
  - `test/highlight`: tree-sitter syntax highlight test files, run with `tree-sitter test`
- `bindings/`: Language-specific bindings.
- `queries/`: Tree-sitter queries for highlighting and indentation.

## Dev Tips

- After changing `./grammar.js` (re)generate the parsers: `tree-sitter generate`
- Test a file `tree-sitter test <file>`

Test common subsections of syntax in the underscore file `test/_.goal`.

## Usefull Links
- [Tree Sitter: Syntax Highlighting](https://tree-sitter.github.io/tree-sitter/3-syntax-highlighting.html)

## Extra info

### Dyadic expression
Simple dyadic expressions with a binairy operator fail to parse:

```
1+2
```

results in
```
S [0, 0] - [1, 0]
  E [0, 0] - [1, 0]
    n [0, 0] - [0, 1]
      int [0, 0] - [0, 1]
    ERROR [0, 1] - [0, 2]
      ERROR [0, 1] - [0, 2]
    n [0, 2] - [0, 3]
      int [0, 2] - [0, 3]
```

While I would excpect an expresiion with a noun (int) verb and noun (int).

### Assignment

```
a:1
```

results in:

```
S [0, 0] - [1, 0]
  E [0, 0] - [1, 0]
    n [0, 0] - [0, 1]
      name [0, 0] - [0, 1]
    ERROR [0, 1] - [0, 2]
      ERROR [0, 1] - [0, 2]
    n [0, 2] - [0, 3]
      int [0, 2] - [0, 3]
```

This is just another expression

### Op Assignment

Syntactic suggar for a:a+1

```
a+:1
```

### List Assignment

Assign the numbers 0, 1 and 2 to the names `a`, `b` and `c`:
```
(a;b;c):!3
```

### Index Op Assignment

Increment the item at position 2 in a:

```
a[2]+:1
```

### Fold

The fold adverb `/` is currenly parsed as a comment.

Example of a fold of a list of 10 numbers `!10` folded `\` over the addiotn operator `+`

```
+/!10
```

It should be parsed the same way as the scan `\` adverb.

```
+\!10
```

A inline comment is only when the `/` is preseeded by whitespace.
A line comment is just a line that starts with `/` followed by text.
A Multi line comment starts with line cointainign only `/`

### Call Syntax

Sum of 1 + 2 + 3
```
+[1;2;3]
```

The `:` operator can be called like any other dyadic opeator as idenity function:
```
:[42]
```

Ofcourse a name or lambda can also by called:

```
{x+y}[1;2]
```

```
f[1;2]
```

### Explicit Apply

Apply the number 2 to the lambda `{x+1}`

```
{x+1}@2
```

### Implicit Apply

```
{x+1} 2
```
